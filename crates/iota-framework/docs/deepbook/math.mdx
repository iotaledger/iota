---
title: Module 0xdee9::math
sidebar_label: math
---
import Link from '@docusaurus/Link';

<Link id="0xdee9_math"/>


-  [Constants](#@Constants_0)
-  [Function `unsafe_mul`](#0xdee9_math_unsafe_mul)
-  [Function `unsafe_mul_round`](#0xdee9_math_unsafe_mul_round)
-  [Function `mul`](#0xdee9_math_mul)
-  [Function `mul_round`](#0xdee9_math_mul_round)
-  [Function `unsafe_div`](#0xdee9_math_unsafe_div)
-  [Function `unsafe_div_round`](#0xdee9_math_unsafe_div_round)
-  [Function `div_round`](#0xdee9_math_div_round)
-  [Function `count_leading_zeros`](#0xdee9_math_count_leading_zeros)


<pre><code>
</code></pre>



<Link id="@Constants_0"></Link>

## Constants


<Link id="0xdee9_math_EUnderflow"></Link>



<pre><code>
<b>const</b> <Link to="math#0xdee9_math_EUnderflow">EUnderflow</Link>: u64 = 1;
</code></pre>



<Link id="0xdee9_math_FLOAT_SCALING"></Link>

scaling setting for float


<pre><code>
<b>const</b> <Link to="math#0xdee9_math_FLOAT_SCALING">FLOAT_SCALING</Link>: u64 = 1000000000;
</code></pre>



<Link id="0xdee9_math_FLOAT_SCALING_U128"></Link>



<pre><code>
<b>const</b> <Link to="math#0xdee9_math_FLOAT_SCALING_U128">FLOAT_SCALING_U128</Link>: u128 = 1000000000;
</code></pre>



<Link id="0xdee9_math_unsafe_mul"></Link>

## Function `unsafe_mul`



<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="math#0xdee9_math_unsafe_mul">unsafe_mul</Link>(x: u64, y: u64): u64
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="math#0xdee9_math_unsafe_mul">unsafe_mul</Link>(x: u64, y: u64): u64 \{
    <b>let</b> (_, result) = <Link to="math#0xdee9_math_unsafe_mul_round">unsafe_mul_round</Link>(x, y);
    result
}
</code></pre>



</details>

<Link id="0xdee9_math_unsafe_mul_round"></Link>

## Function `unsafe_mul_round`



<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="math#0xdee9_math_unsafe_mul_round">unsafe_mul_round</Link>(x: u64, y: u64): (bool, u64)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="math#0xdee9_math_unsafe_mul_round">unsafe_mul_round</Link>(x: u64, y: u64): (bool, u64) \{
    <b>let</b> x = x <b>as</b> u128;
    <b>let</b> y = y <b>as</b> u128;
    <b>let</b> <b>mut</b> is_round_down = <b>true</b>;
    <b>if</b> ((x * y) % <Link to="math#0xdee9_math_FLOAT_SCALING_U128">FLOAT_SCALING_U128</Link> == 0) is_round_down = <b>false</b>;
    (is_round_down, (x * y / <Link to="math#0xdee9_math_FLOAT_SCALING_U128">FLOAT_SCALING_U128</Link>) <b>as</b> u64)
}
</code></pre>



</details>

<Link id="0xdee9_math_mul"></Link>

## Function `mul`



<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_mul">mul</Link>(x: u64, y: u64): u64
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_mul">mul</Link>(x: u64, y: u64): u64 \{
    <b>let</b> (_, result) = <Link to="math#0xdee9_math_unsafe_mul_round">unsafe_mul_round</Link>(x, y);
    <b>assert</b>!(result &gt; 0, <Link to="math#0xdee9_math_EUnderflow">EUnderflow</Link>);
    result
}
</code></pre>



</details>

<Link id="0xdee9_math_mul_round"></Link>

## Function `mul_round`



<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_mul_round">mul_round</Link>(x: u64, y: u64): (bool, u64)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_mul_round">mul_round</Link>(x: u64, y: u64): (bool, u64) \{
    <b>let</b> (is_round_down, result) = <Link to="math#0xdee9_math_unsafe_mul_round">unsafe_mul_round</Link>(x, y);
    <b>assert</b>!(result &gt; 0, <Link to="math#0xdee9_math_EUnderflow">EUnderflow</Link>);
    (is_round_down, result)
}
</code></pre>



</details>

<Link id="0xdee9_math_unsafe_div"></Link>

## Function `unsafe_div`



<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="math#0xdee9_math_unsafe_div">unsafe_div</Link>(x: u64, y: u64): u64
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="math#0xdee9_math_unsafe_div">unsafe_div</Link>(x: u64, y: u64): u64 \{
    <b>let</b> (_, result) = <Link to="math#0xdee9_math_unsafe_div_round">unsafe_div_round</Link>(x, y);
    result
}
</code></pre>



</details>

<Link id="0xdee9_math_unsafe_div_round"></Link>

## Function `unsafe_div_round`



<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="math#0xdee9_math_unsafe_div_round">unsafe_div_round</Link>(x: u64, y: u64): (bool, u64)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="math#0xdee9_math_unsafe_div_round">unsafe_div_round</Link>(x: u64, y: u64): (bool, u64) \{
    <b>let</b> x = x <b>as</b> u128;
    <b>let</b> y = y <b>as</b> u128;
    <b>let</b> <b>mut</b> is_round_down = <b>true</b>;
    <b>if</b> ((x * (<Link to="math#0xdee9_math_FLOAT_SCALING">FLOAT_SCALING</Link> <b>as</b> u128) % y) == 0) is_round_down = <b>false</b>;
    (is_round_down, (x * (<Link to="math#0xdee9_math_FLOAT_SCALING">FLOAT_SCALING</Link> <b>as</b> u128) / y) <b>as</b> u64)
}
</code></pre>



</details>

<Link id="0xdee9_math_div_round"></Link>

## Function `div_round`



<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_div_round">div_round</Link>(x: u64, y: u64): (bool, u64)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="math#0xdee9_math_div_round">div_round</Link>(x: u64, y: u64): (bool, u64) \{
    <b>let</b> (is_round_down, result) = <Link to="math#0xdee9_math_unsafe_div_round">unsafe_div_round</Link>(x, y);
    <b>assert</b>!(result &gt; 0, <Link to="math#0xdee9_math_EUnderflow">EUnderflow</Link>);
    (is_round_down, result)
}
</code></pre>



</details>

<Link id="0xdee9_math_count_leading_zeros"></Link>

## Function `count_leading_zeros`



<pre><code>
<b>public</b>(<b>friend</b>) <b>fun</b> <Link to="math#0xdee9_math_count_leading_zeros">count_leading_zeros</Link>(x: u128): u8
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b>(package) <b>fun</b> <Link to="math#0xdee9_math_count_leading_zeros">count_leading_zeros</Link>(<b>mut</b> x: u128): u8 \{
    <b>if</b> (x == 0) \{
        128
    } <b>else</b> \{
        <b>let</b> <b>mut</b> n: u8 = 0;
        <b>if</b> (x & 0xFFFFFFFFFFFFFFFF0000000000000000 == 0) \{
            // x's higher 64 is all zero, shift the lower part over
            x = x &lt;&lt; 64;
            n = n + 64;
        };
        <b>if</b> (x & 0xFFFFFFFF000000000000000000000000 == 0) \{
            // x's higher 32 is all zero, shift the lower part over
            x = x &lt;&lt; 32;
            n = n + 32;
        };
        <b>if</b> (x & 0xFFFF0000000000000000000000000000 == 0) \{
            // x's higher 16 is all zero, shift the lower part over
            x = x &lt;&lt; 16;
            n = n + 16;
        };
        <b>if</b> (x & 0xFF000000000000000000000000000000 == 0) \{
            // x's higher 8 is all zero, shift the lower part over
            x = x &lt;&lt; 8;
            n = n + 8;
        };
        <b>if</b> (x & 0xF0000000000000000000000000000000 == 0) \{
            // x's higher 4 is all zero, shift the lower part over
            x = x &lt;&lt; 4;
            n = n + 4;
        };
        <b>if</b> (x & 0xC0000000000000000000000000000000 == 0) \{
            // x's higher 2 is all zero, shift the lower part over
            x = x &lt;&lt; 2;
            n = n + 2;
        };
        <b>if</b> (x & 0x80000000000000000000000000000000 == 0) \{
            n = n + 1;
        };

        n
    }
}
</code></pre>



</details>
