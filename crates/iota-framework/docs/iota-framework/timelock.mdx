---
title: Module 0x2::timelock
sidebar_label: timelock
---
import Link from '@docusaurus/Link';

<Link id="0x2_timelock"/>
A timelock implementation.


-  [Resource `TimeLock`](#0x2_timelock_TimeLock)
-  [Struct `SystemTimelockCap`](#0x2_timelock_SystemTimelockCap)
-  [Constants](#@Constants_0)
-  [Function `lock`](#0x2_timelock_lock)
-  [Function `lock_with_label`](#0x2_timelock_lock_with_label)
-  [Function `lock_and_transfer`](#0x2_timelock_lock_and_transfer)
-  [Function `lock_with_label_and_transfer`](#0x2_timelock_lock_with_label_and_transfer)
-  [Function `unlock`](#0x2_timelock_unlock)
-  [Function `join`](#0x2_timelock_join)
-  [Function `join_vec`](#0x2_timelock_join_vec)
-  [Function `split`](#0x2_timelock_split)
-  [Function `split_balance`](#0x2_timelock_split_balance)
-  [Function `transfer_to_sender`](#0x2_timelock_transfer_to_sender)
-  [Function `system_pack`](#0x2_timelock_system_pack)
-  [Function `system_unpack`](#0x2_timelock_system_unpack)
-  [Function `type_name`](#0x2_timelock_type_name)
-  [Function `expiration_timestamp_ms`](#0x2_timelock_expiration_timestamp_ms)
-  [Function `is_locked`](#0x2_timelock_is_locked)
-  [Function `remaining_time`](#0x2_timelock_remaining_time)
-  [Function `locked`](#0x2_timelock_locked)
-  [Function `label`](#0x2_timelock_label)
-  [Function `is_labeled_with`](#0x2_timelock_is_labeled_with)
-  [Function `pack`](#0x2_timelock_pack)
-  [Function `unpack`](#0x2_timelock_unpack)
-  [Function `transfer`](#0x2_timelock_transfer)
-  [Function `check_expiration_timestamp_ms`](#0x2_timelock_check_expiration_timestamp_ms)
-  [Function `new_system_timelock_cap`](#0x2_timelock_new_system_timelock_cap)


<pre><code>
<b>use</b> <Link to="../move-stdlib/ascii#0x1_ascii">0x1::ascii</Link>;
<b>use</b> <Link to="../move-stdlib/option#0x1_option">0x1::option</Link>;
<b>use</b> <Link to="../move-stdlib/string#0x1_string">0x1::string</Link>;
<b>use</b> <Link to="../move-stdlib/type_name#0x1_type_name">0x1::type_name</Link>;
<b>use</b> <Link to="../iota-framework/balance#0x2_balance">0x2::balance</Link>;
<b>use</b> <Link to="../iota-framework/labeler#0x2_labeler">0x2::labeler</Link>;
<b>use</b> <Link to="../iota-framework/object#0x2_object">0x2::object</Link>;
<b>use</b> <Link to="../iota-framework/transfer#0x2_transfer">0x2::transfer</Link>;
<b>use</b> <Link to="../iota-framework/tx_context#0x2_tx_context">0x2::tx_context</Link>;
</code></pre>



<Link id="0x2_timelock_TimeLock"></Link>

## Resource `TimeLock`


<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> struct that holds a locked object.


<pre><code>
<b>struct</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T: store&gt; <b>has</b> key
</code></pre>



<details>
<summary>Fields</summary>


<dl>
<dt>

id: <Link to="../iota-framework/object#0x2_object_UID">object::UID</Link>
</dt>
<dd>

</dd>
<dt>

locked: T
</dt>
<dd>
 The locked object.
</dd>
<dt>

expiration_timestamp_ms: u64
</dt>
<dd>
 This is the epoch time stamp of when the lock expires.
</dd>
<dt>

label: <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;
</dt>
<dd>
 Timelock related label.
</dd>
</dl>


</details>

<Link id="0x2_timelock_SystemTimelockCap"></Link>

## Struct `SystemTimelockCap`


<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link> allows to 
pack and 
unpack TimeLocks


<pre><code>
<b>struct</b> <Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link> <b>has</b> store
</code></pre>



<details>
<summary>Fields</summary>


<dl>
<dt>

dummy_field: bool
</dt>
<dd>

</dd>
</dl>


</details>

<Link id="@Constants_0"></Link>

## Constants


<Link id="0x2_timelock_ENotSystemAddress"></Link>

Sender is not @0x0 the system address.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_ENotSystemAddress">ENotSystemAddress</Link>: u64 = 1;
</code></pre>



<Link id="0x2_timelock_EDifferentExpirationTime"></Link>

For when trying to join two time-locked balances with different expiration time.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_EDifferentExpirationTime">EDifferentExpirationTime</Link>: u64 = 4;
</code></pre>



<Link id="0x2_timelock_EDifferentLabels"></Link>

For when trying to join two time-locked balances with different labels.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_EDifferentLabels">EDifferentLabels</Link>: u64 = 5;
</code></pre>



<Link id="0x2_timelock_EExpireEpochIsPast"></Link>

Expiration timestamp of the lock is in the past.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_EExpireEpochIsPast">EExpireEpochIsPast</Link>: u64 = 2;
</code></pre>



<Link id="0x2_timelock_ENotCalledAtGenesis"></Link>

The 
new function was called at a non-genesis epoch.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_ENotCalledAtGenesis">ENotCalledAtGenesis</Link>: u64 = 0;
</code></pre>



<Link id="0x2_timelock_ENotExpiredYet"></Link>

The lock has not expired yet.


<pre><code>
<b>const</b> <Link to="../iota-framework/timelock#0x2_timelock_ENotExpiredYet">ENotExpiredYet</Link>: u64 = 3;
</code></pre>



<Link id="0x2_timelock_lock"></Link>

## Function `lock`

Function to lock an object till a unix timestamp in milliseconds.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock">lock</Link>&lt;T: store&gt;(locked: T, expiration_timestamp_ms: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock">lock</Link>&lt;T: store&gt;(locked: T, expiration_timestamp_ms: u64, ctx: &<b>mut</b> TxContext): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt; \{
    // Check that `expiration_timestamp_ms` is valid.
    <Link to="../iota-framework/timelock#0x2_timelock_check_expiration_timestamp_ms">check_expiration_timestamp_ms</Link>(expiration_timestamp_ms, ctx);

    // Create a <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>(locked, expiration_timestamp_ms, <Link to="../move-stdlib/option#0x1_option_none">option::none</Link>(), ctx)
}
</code></pre>



</details>

<Link id="0x2_timelock_lock_with_label"></Link>

## Function `lock_with_label`

Function to lock a labeled object till a unix timestamp in milliseconds.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_with_label">lock_with_label</Link>&lt;T: store, L&gt;(_: &<Link to="../iota-framework/labeler#0x2_labeler_LabelerCap">labeler::LabelerCap</Link>&lt;L&gt;, locked: T, expiration_timestamp_ms: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_with_label">lock_with_label</Link>&lt;T: store, L&gt;(
    _: &LabelerCap&lt;L&gt;,
    locked: T,
    expiration_timestamp_ms: u64,
    ctx: &<b>mut</b> TxContext
): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt; \{
    // Check that `expiration_timestamp_ms` is valid.
    <Link to="../iota-framework/timelock#0x2_timelock_check_expiration_timestamp_ms">check_expiration_timestamp_ms</Link>(expiration_timestamp_ms, ctx);

    // Calculate a label value.
    <b>let</b> label = <Link to="../move-stdlib/type_name#0x1_type_name">type_name</Link>&lt;L&gt;();

    // Create a labeled <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>(locked, expiration_timestamp_ms, <Link to="../move-stdlib/option#0x1_option_some">option::some</Link>(label), ctx)
}
</code></pre>



</details>

<Link id="0x2_timelock_lock_and_transfer"></Link>

## Function `lock_and_transfer`

Function to lock an object 
obj until 
expiration_timestamp_ms and transfer it to address 
<b>to</b>.
Since 
Timelock&lt;T&gt; does not support public transfer, use this function to lock an object to an address.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_and_transfer">lock_and_transfer</Link>&lt;T: store&gt;(obj: T, <b>to</b>: <b>address</b>, expiration_timestamp_ms: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_and_transfer">lock_and_transfer</Link>&lt;T: store&gt;(
    obj: T,
    <b>to</b>: <b>address</b>,
    expiration_timestamp_ms: u64,
    ctx: &<b>mut</b> TxContext
) \{
    <Link to="../iota-framework/transfer#0x2_transfer">transfer</Link>(<Link to="../iota-framework/timelock#0x2_timelock_lock">lock</Link>(obj, expiration_timestamp_ms, ctx), <b>to</b>);
}
</code></pre>



</details>

<Link id="0x2_timelock_lock_with_label_and_transfer"></Link>

## Function `lock_with_label_and_transfer`

Function to lock a labeled object 
obj until 
expiration_timestamp_ms and transfer it to address 
<b>to</b>.
Since 
Timelock&lt;T&gt; does not support public transfer, use this function to lock a labeled object to an address.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_with_label_and_transfer">lock_with_label_and_transfer</Link>&lt;T: store, L&gt;(<Link to="../iota-framework/labeler#0x2_labeler">labeler</Link>: &<Link to="../iota-framework/labeler#0x2_labeler_LabelerCap">labeler::LabelerCap</Link>&lt;L&gt;, obj: T, <b>to</b>: <b>address</b>, expiration_timestamp_ms: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_lock_with_label_and_transfer">lock_with_label_and_transfer</Link>&lt;T: store, L&gt;(
    <Link to="../iota-framework/labeler#0x2_labeler">labeler</Link>: &LabelerCap&lt;L&gt;,
    obj: T,
    <b>to</b>: <b>address</b>,
    expiration_timestamp_ms: u64,
    ctx: &<b>mut</b> TxContext
) \{
    <Link to="../iota-framework/transfer#0x2_transfer">transfer</Link>(<Link to="../iota-framework/timelock#0x2_timelock_lock_with_label">lock_with_label</Link>(<Link to="../iota-framework/labeler#0x2_labeler">labeler</Link>, obj, expiration_timestamp_ms, ctx), <b>to</b>);
}
</code></pre>



</details>

<Link id="0x2_timelock_unlock"></Link>

## Function `unlock`

Function to unlock the object from a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_unlock">unlock</Link>&lt;T: store&gt;(self: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;, ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): T
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_unlock">unlock</Link>&lt;T: store&gt;(self: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;, ctx: &TxContext): T \{
    // Unpack the <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <b>let</b> (locked, expiration_timestamp_ms, _) = <Link to="../iota-framework/timelock#0x2_timelock_unpack">unpack</Link>(self);

    // Check <b>if</b> the lock <b>has</b> expired.
    <b>assert</b>!(<Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link> &lt;= ctx.epoch_timestamp_ms(), <Link to="../iota-framework/timelock#0x2_timelock_ENotExpiredYet">ENotExpiredYet</Link>);

    locked
}
</code></pre>



</details>

<Link id="0x2_timelock_join"></Link>

## Function `join`

Join two 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt; together.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_join">join</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;, other: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_join">join</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;, other: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;) \{
    // Check the preconditions.
    <b>assert</b>!(self.<Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link>() == other.<Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link>(), <Link to="../iota-framework/timelock#0x2_timelock_EDifferentExpirationTime">EDifferentExpirationTime</Link>);
    <b>assert</b>!(self.<Link to="../iota-framework/timelock#0x2_timelock_label">label</Link>() == other.<Link to="../iota-framework/timelock#0x2_timelock_label">label</Link>(), <Link to="../iota-framework/timelock#0x2_timelock_EDifferentLabels">EDifferentLabels</Link>);

    // Unpack the time-locked <Link to="../iota-framework/balance#0x2_balance">balance</Link>.
    <b>let</b> (value, _, _) = <Link to="../iota-framework/timelock#0x2_timelock_unpack">unpack</Link>(other);

    // Join the balances.
    self.locked.<Link to="../iota-framework/timelock#0x2_timelock_join">join</Link>(value);
}
</code></pre>



</details>

<Link id="0x2_timelock_join_vec"></Link>

## Function `join_vec`

Join everything in 
others with 
self.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_join_vec">join_vec</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;, others: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;&gt;)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_join_vec">join_vec</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;, <b>mut</b> others: <Link to="../move-stdlib/vector#0x1_vector">vector</Link>&lt;<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;&gt;) \{
    // Create useful variables.
    <b>let</b> (<b>mut</b> i, len) = (0, others.length());

    // Join all the balances.
    <b>while</b> (i &lt; len) \{
        <b>let</b> other = others.pop_back();
        <Link to="../iota-framework/timelock#0x2_timelock_join">Self::join</Link>(self, other);
        i = i + 1
    };

    // Destroy the empty <Link to="../move-stdlib/vector#0x1_vector">vector</Link>.
    <Link to="../move-stdlib/vector#0x1_vector_destroy_empty">vector::destroy_empty</Link>(others)
}
</code></pre>



</details>

<Link id="0x2_timelock_split"></Link>

## Function `split`

Split a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt; and take a sub balance from it.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_split">split</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;, value: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_split">split</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;, value: u64, ctx: &<b>mut</b> TxContext): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt; \{
    // Split the locked <Link to="../iota-framework/balance#0x2_balance">balance</Link>.
    <b>let</b> value = self.locked.<Link to="../iota-framework/timelock#0x2_timelock_split">split</Link>(value);

    // Pack the split <Link to="../iota-framework/balance#0x2_balance">balance</Link> into a <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>(value, self.<Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link>(), self.<Link to="../iota-framework/timelock#0x2_timelock_label">label</Link>(), ctx)
}
</code></pre>



</details>

<Link id="0x2_timelock_split_balance"></Link>

## Function `split_balance`

Split the given 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt; into two parts, one with principal 
value,
and transfer the newly split part to the sender address.


<pre><code>
<b>public</b> entry <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_split_balance">split_balance</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;<Link to="../iota-framework/balance#0x2_balance_Balance">balance::Balance</Link>&lt;T&gt;&gt;, value: u64, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> entry <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_split_balance">split_balance</Link>&lt;T&gt;(self: &<b>mut</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;Balance&lt;T&gt;&gt;, value: u64, ctx: &<b>mut</b> TxContext) \{
    <Link to="../iota-framework/timelock#0x2_timelock_split">split</Link>(self, value, ctx).<Link to="../iota-framework/timelock#0x2_timelock_transfer_to_sender">transfer_to_sender</Link>(ctx)
}
</code></pre>



</details>

<Link id="0x2_timelock_transfer_to_sender"></Link>

## Function `transfer_to_sender`

A utility function to transfer a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> to the sender.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_transfer_to_sender">transfer_to_sender</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;, ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_transfer_to_sender">transfer_to_sender</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;, ctx: &TxContext) \{
    <Link to="../iota-framework/transfer#0x2_transfer">transfer</Link>(lock, ctx.sender())
}
</code></pre>



</details>

<Link id="0x2_timelock_system_pack"></Link>

## Function `system_pack`

A utility function to pack a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> that can be invoked only by a system package.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_system_pack">system_pack</Link>&lt;T: store&gt;(_: &<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">timelock::SystemTimelockCap</Link>, locked: T, expiration_timestamp_ms: u64, label: <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_system_pack">system_pack</Link>&lt;T: store&gt;(
    _: &<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link>,
    locked: T,
    expiration_timestamp_ms: u64,
    label: Option&lt;String&gt;,
    ctx: &<b>mut</b> TxContext): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;
\{
    <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>(locked, expiration_timestamp_ms, label, ctx)
}
</code></pre>



</details>

<Link id="0x2_timelock_system_unpack"></Link>

## Function `system_unpack`

An utility function to unpack a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> that can be invoked only by a system package.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_system_unpack">system_unpack</Link>&lt;T: store&gt;(_: &<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">timelock::SystemTimelockCap</Link>, lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): (T, u64, <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_system_unpack">system_unpack</Link>&lt;T: store&gt;(_: &<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link>, lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): (T, u64, Option&lt;String&gt;) \{
    <Link to="../iota-framework/timelock#0x2_timelock_unpack">unpack</Link>(lock)
}
</code></pre>



</details>

<Link id="0x2_timelock_type_name"></Link>

## Function `type_name`

Return a fully qualified type name with the original package IDs
that is used as type related a label value.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../move-stdlib/type_name#0x1_type_name">type_name</Link>&lt;L&gt;(): <Link to="../move-stdlib/string#0x1_string_String">string::String</Link>
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../move-stdlib/type_name#0x1_type_name">type_name</Link>&lt;L&gt;(): String \{
    <Link to="../move-stdlib/string#0x1_string_from_ascii">string::from_ascii</Link>(std::type_name::get_with_original_ids&lt;L&gt;().into_string())
}
</code></pre>



</details>

<Link id="0x2_timelock_expiration_timestamp_ms"></Link>

## Function `expiration_timestamp_ms`

Function to get the expiration timestamp of a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): u64
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): u64 \{
    self.expiration_timestamp_ms
}
</code></pre>



</details>

<Link id="0x2_timelock_is_locked"></Link>

## Function `is_locked`

Function to check if a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> is locked.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_is_locked">is_locked</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;, ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): bool
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_is_locked">is_locked</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;, ctx: &TxContext): bool \{
    self.<Link to="../iota-framework/timelock#0x2_timelock_remaining_time">remaining_time</Link>(ctx) &gt; 0
}
</code></pre>



</details>

<Link id="0x2_timelock_remaining_time"></Link>

## Function `remaining_time`

Function to get the remaining time of a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.
Returns 0 if the lock has expired.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_remaining_time">remaining_time</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;, ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): u64
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_remaining_time">remaining_time</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;, ctx: &TxContext): u64 \{
    // Get the epoch timestamp.
    <b>let</b> current_timestamp_ms = ctx.epoch_timestamp_ms();

    // Check <b>if</b> the lock <b>has</b> expired.
    <b>if</b> (self.<Link to="../iota-framework/timelock#0x2_timelock_expiration_timestamp_ms">expiration_timestamp_ms</Link> &lt; current_timestamp_ms) \{
        <b>return</b> 0
    };

    // Calculate the remaining time.
    self.expiration_timestamp_ms - current_timestamp_ms
}
</code></pre>



</details>

<Link id="0x2_timelock_locked"></Link>

## Function `locked`

Function to get the locked object of a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_locked">locked</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): &T
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_locked">locked</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): &T \{
    &self.locked
}
</code></pre>



</details>

<Link id="0x2_timelock_label"></Link>

## Function `label`

Function to get the label of a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_label">label</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_label">label</Link>&lt;T: store&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): Option&lt;String&gt; \{
    self.label
}
</code></pre>



</details>

<Link id="0x2_timelock_is_labeled_with"></Link>

## Function `is_labeled_with`

Check if a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> is labeled with the type 
L.


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_is_labeled_with">is_labeled_with</Link>&lt;T: store, L&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): bool
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>public</b> <b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_is_labeled_with">is_labeled_with</Link>&lt;T: store, L&gt;(self: &<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): bool \{
    <b>if</b> (self.label.is_some()) \{
        self.label.borrow() == <Link to="../move-stdlib/type_name#0x1_type_name">type_name</Link>&lt;L&gt;()
    }
    <b>else</b> \{
        <b>false</b>
    }
}
</code></pre>



</details>

<Link id="0x2_timelock_pack"></Link>

## Function `pack`

A utility function to pack a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>&lt;T: store&gt;(locked: T, expiration_timestamp_ms: u64, label: <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;, ctx: &<b>mut</b> <Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_pack">pack</Link>&lt;T: store&gt;(
    locked: T,
    expiration_timestamp_ms: u64,
    label: Option&lt;String&gt;,
    ctx: &<b>mut</b> TxContext): <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;
\{
    // Create a <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> \{
        id: <Link to="../iota-framework/object#0x2_object_new">object::new</Link>(ctx),
        locked,
        expiration_timestamp_ms,
        label,
    }
}
</code></pre>



</details>

<Link id="0x2_timelock_unpack"></Link>

## Function `unpack`

An utility function to unpack a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>.


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_unpack">unpack</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;): (T, u64, <Link to="../move-stdlib/option#0x1_option_Option">option::Option</Link>&lt;<Link to="../move-stdlib/string#0x1_string_String">string::String</Link>&gt;)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_unpack">unpack</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;): (T, u64, Option&lt;String&gt;) \{
    // Unpack the <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <b>let</b> <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> \{
        id,
        locked,
        expiration_timestamp_ms,
        label,
    } = lock;

    // Delete the <Link to="../iota-framework/timelock#0x2_timelock">timelock</Link>.
    <Link to="../iota-framework/object#0x2_object_delete">object::delete</Link>(id);

    (locked, expiration_timestamp_ms, label)
}
</code></pre>



</details>

<Link id="0x2_timelock_transfer"></Link>

## Function `transfer`

A utility function to transfer a 
<Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link> to a receiver.


<pre><code>
<b>fun</b> <Link to="../iota-framework/transfer#0x2_transfer">transfer</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">timelock::TimeLock</Link>&lt;T&gt;, receiver: <b>address</b>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/transfer#0x2_transfer">transfer</Link>&lt;T: store&gt;(lock: <Link to="../iota-framework/timelock#0x2_timelock_TimeLock">TimeLock</Link>&lt;T&gt;, receiver: <b>address</b>) \{
    <Link to="../iota-framework/transfer#0x2_transfer_transfer">transfer::transfer</Link>(lock, receiver);
}
</code></pre>



</details>

<Link id="0x2_timelock_check_expiration_timestamp_ms"></Link>

## Function `check_expiration_timestamp_ms`

An utility function to check that the 
expiration_timestamp_ms value is valid.


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_check_expiration_timestamp_ms">check_expiration_timestamp_ms</Link>(expiration_timestamp_ms: u64, ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>)
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_check_expiration_timestamp_ms">check_expiration_timestamp_ms</Link>(expiration_timestamp_ms: u64, ctx: &TxContext) \{
    // Get the epoch timestamp.
    <b>let</b> epoch_timestamp_ms = ctx.epoch_timestamp_ms();

    // Check that `expiration_timestamp_ms` is valid.
    <b>assert</b>!(expiration_timestamp_ms &gt; epoch_timestamp_ms, <Link to="../iota-framework/timelock#0x2_timelock_EExpireEpochIsPast">EExpireEpochIsPast</Link>);
}
</code></pre>



</details>

<Link id="0x2_timelock_new_system_timelock_cap"></Link>

## Function `new_system_timelock_cap`

Create a 
<Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link>.
This should be called only once during genesis creation.


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_new_system_timelock_cap">new_system_timelock_cap</Link>(ctx: &<Link to="../iota-framework/tx_context#0x2_tx_context_TxContext">tx_context::TxContext</Link>): <Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">timelock::SystemTimelockCap</Link>
</code></pre>



<details>
<summary>Implementation</summary>


<pre><code>
<b>fun</b> <Link to="../iota-framework/timelock#0x2_timelock_new_system_timelock_cap">new_system_timelock_cap</Link>(ctx: &TxContext): <Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link> \{
    <b>assert</b>!(ctx.sender() == @0x0, <Link to="../iota-framework/timelock#0x2_timelock_ENotSystemAddress">ENotSystemAddress</Link>);
    <b>assert</b>!(ctx.epoch() == 0, <Link to="../iota-framework/timelock#0x2_timelock_ENotCalledAtGenesis">ENotCalledAtGenesis</Link>);

    <Link to="../iota-framework/timelock#0x2_timelock_SystemTimelockCap">SystemTimelockCap</Link> \{}
}
</code></pre>



</details>
